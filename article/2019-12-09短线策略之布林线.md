---
layout:     post
title:      "短线策略之布林线"
subtitle:   ""
date:       2019-12-09
author:     "Cactus"
header-img: "img/fj-bg2.jpg"
tags:
    - 量化
    - 策略
    - 股票
---

近日在雪球上看到一个推送的文章，内容讲的是个简单的策略，大概意思是当股价突破布林线的中线时，此后股价大概率会上扬。出于好(贪)奇(婪)心，决定研究一下。



我选择研究的对象是最新的上证50成分股，测试期间选择2008年7月到2019年12月。在这里，先定义几个术语：

- 买入条件：按照上述策略，默认的触发条件是股价突破布林线中线。但是具体用最高价，收盘价还是其他价格，需要详细定义。
- 试验：对于一只股票，满足一次"触发条件"即称为一次试验。
- 试验结果：用于定义策略是否成功。我们可以定义收盘价大于买入价，或者最高价大于买入价等等。当我认为一次"试验"是成功的，返回1，反之返回0。
- 测试：通过调整上面的参数，完成多个"试验"，从而形成一个有统计意义的"测试”
- dN：代表买入后第N日。比如，今天是买入日，d1代表买入后的下一日，即明天。d2代表买入后的第二日，即后天

除了定义这些"术语"，我的测试还基于如下几个假设条件：

- 假设我可以以当日收盘价买入。实际上，我可以实时监测当日价格，尾盘买入，认为尾盘的价格就是收盘价。这个假设要求尾盘不可以有暴跌（暴涨当然对我们是利好啦）。
- 交易成本足够低，所有成本应控制在千分之3以下。



**测试一**

买入条件：当日收盘价突破布林线中线

成功条件：买入后第N日收盘价 - 买入价 > 0%

本次测试包含试验数：6628次

dN日后"成功"的概率：

d1    0.472993
d2    0.500000
d3    0.507242
d4    0.509807
d5    0.498793



**测试二**

买入条件：当日收盘价突破布林线中线

成功条件：买入后第N日收盘价 - 买入价 > 0.5%

本次测试包含试验数：6628次

dN日后"成功"的概率：

d1    0.349427
d2    0.417019
d3    0.445081
d4    0.457755
d5    0.451569



**由测试一的结果可以看出，突破布林中线，短期内股价上涨概率在50%左右，所以对股价没有任何影响。为什么要进行测试二呢？因为考虑到交易成本，我假设每次交易至少要获利0.5%以上，才能实现微盈利。加入0.5%的限制后，"成功"的概率变得更低了**

---

**测试三**

买入条件：当日收盘价突破布林线中线

成功条件：买入后第N日最高价 - 买入价 > 0%

本次测试包含试验数：6628次

dN日后"成功"的概率：

d1    0.837658
d2    0.703530
d3    0.666113
d4    0.643030
d5    0.618739

**测试四**

买入条件：当日收盘价突破布林线中线

成功条件：买入后第N日最高价 - 买入价 > 0.5%

本次测试包含试验数：6628次

dN日后"成功"的概率：

d1    0.671394
d2    0.611798
d3    0.599578
d4    0.592637
d5    0.571817



**这两组测试和前面的不同是，判断买入是否成功，改为用dN日最高价减去收盘价来衡量。最高价代表来当日最少有1手这样的成交价格，如果可以程序化交易，再小的蚊子也是肉（渣）。我发现，股价突破布林线中线后，d1日是最佳的卖出点，越往后推，成功的可能性就越低。难道说，突破布林线中线，其实是短期顶？而不是好的买入点么？**

---

**测试五**

买入条件：当日收盘价**没有突破**布林线中线

成功条件：买入后第N日最高价 - 买入价 > 0.5%

本次测试包含试验数：111418次

dN日后"成功"的概率：

d1    0.688803
d2    0.607505
d3    0.584681
d4    0.573974
d5    0.565384

**这个测试的结果，进一步说明是否突破布林线中线，对于短期内的股价没有影响。因为测试了没有'突破’的日期，测试结果和测试四差不多，甚至好于突破布林中线的情况。**

---



**测试六**

买入条件：当日收盘价突破布林线中线 并且 "今日"价格不可以是跳空高开

成功条件：买入后第N日最高价 - 买入价 > 0.5%

本次测试包含试验数：765次

dN日后"成功"的概率：
d1    0.692810
d2    0.620915
d3    0.601307
d4    0.597386
d5    0.588235



**我在尝试加入更多的买入条件，避免在跳空高开的情况下买入，可以有效提升成功概率**

****

**测试七**

买入条件：当日收盘价突破布林线中线 并且 "今日"价格不可以是跳空高开

成功条件：买入后第N日最高价 - 买入价 > 0.5%

dN日后"成功"的概率：
cd1    0.692208
cd2    0.768831
cd3    0.801299
cd4    0.825974
cd5    0.838961



**测试八**

买入条件：当日收盘价突破布林线中线 并且 "今日"价格不可以是跳空高开

成功条件：买入后第N日最高价 - 买入价 > 0.5%

dN日后"成功"的概率：

cd1    0.752559
cd2    0.817343
cd3    0.849901
cd4    0.869545
cd5    0.882264

**细心的你会发现，这2个测试，我讲dN改写成了cdN。因为dN代表了第N日和买入日的对比，cdN的意义是从买入日到第N日的区间，即我认为只要5日内可以达到卖出价格，都算做成功。从测试七可以看出，成功的概率还是很大的，测试八用中证500成分股替换了上证50成分股，成功概率大大提升。这也说明，这个蚊子腿策略更适合中小盘股，毕竟波动会大一些。**



最后附上代码，位置：

https://github.com/cactusgame/awesome/blob/master/src/research/bolling.py